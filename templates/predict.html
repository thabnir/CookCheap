<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recipe Cards</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
    }
    .card-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: start;
    }
    .card {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 10px;
        width: 200px;
        cursor: pointer;
        transition: transform 0.2s;
        box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
    }
    .card:hover {
        transform: scale(1.05);
    }
    .subclasses {
        margin-top: 10px;
    }
    .subclass-item {
        background-color: #f0f0f0;
        border-radius: 4px;
        padding: 5px;
        margin-top: 5px;
        cursor: pointer;
    }
    .subclass-item:hover {
        background-color: #e0e0e0;
    }
</style>
</head>
<body>

<div class="card-container" id="recipe-cards"></div>

<script>
// Parse the given JSON data and use it to create recipe cards
const data = {{ dishes|tojson|safe }};

function postRecipeName(recipeName) {
    fetch('get_recipes', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ recipe_name: recipeName })
    })
    .then(response => response.json())
    .then(data => console.log(data))
    .catch(error => console.error('Error:', error));
}

function createCard(recipe) {
    const card = document.createElement('div');
    card.className = 'card';
    card.textContent = recipe.name;
    card.onclick = () => postRecipeName(recipe.name);

    if (recipe.subclasses.length > 0) {
        const subclassContainer = document.createElement('div');
        subclassContainer.className = 'subclasses';
        recipe.subclasses.forEach(subclass => {
            const subclassElement = document.createElement('div');
            subclassElement.className = 'subclass-item';
            subclassElement.textContent = subclass.name;
            subclassElement.onclick = (event) => {
                event.stopPropagation(); // Prevent trigger of the parent card click
                postRecipeName(subclass.name);
            };
            subclassContainer.appendChild(subclassElement);
        });
        card.appendChild(subclassContainer);
    }
    
    return card;
}

function renderRecipeCards() {
    const container = document.getElementById('recipe-cards');
    data[0].recognition_results.forEach(recipe => {
        container.appendChild(createCard(recipe));
    });
}

renderRecipeCards();
</script>

</body>
</html>